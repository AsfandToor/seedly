{"version":3,"sources":["../../../src/core/agent.ts"],"sourcesContent":["import { TavilySearchResults } from '@langchain/community/tools/tavily_search';\nimport { ChatGoogleGenerativeAI } from '@langchain/google-genai';\nimport { HumanMessage } from '@langchain/core/messages';\nimport { createReactAgent } from '@langchain/langgraph/prebuilt';\nimport 'dotenv/config';\n\ninterface AgentConfig {\n  model?: string;\n  temperature?: number;\n  maxResults?: number;\n}\n\nexport class SeedingAgent {\n  private agent: ReturnType<typeof createReactAgent>;\n  private model: ChatGoogleGenerativeAI;\n  private tools: TavilySearchResults[];\n\n  constructor(config: AgentConfig = {}) {\n    const {\n      model = 'gemini-2.0-flash',\n      temperature = 0,\n      maxResults = 3,\n    } = config;\n\n    this.model = new ChatGoogleGenerativeAI({\n      temperature,\n      model,\n    });\n\n    this.tools = [new TavilySearchResults({ maxResults })];\n\n    this.agent = createReactAgent({\n      llm: this.model,\n      tools: this.tools,\n    });\n  }\n\n  async invoke(\n    message: string,\n    threadId: string = 'default',\n  ): Promise<string> {\n    try {\n      const agentFinalState = await this.agent.invoke(\n        {\n          messages: [new HumanMessage(message)],\n        },\n        { configurable: { thread_id: threadId } },\n      );\n\n      const lastMessage =\n        agentFinalState.messages[\n          agentFinalState.messages.length - 1\n        ];\n      return lastMessage.content as string;\n    } catch (error) {\n      console.error('Error invoking agent:', error);\n      throw error;\n    }\n  }\n\n  async *streamResponse(\n    message: string,\n    threadId: string = 'default',\n  ): AsyncGenerator<string> {\n    try {\n      const agentFinalState = await this.agent.invoke(\n        {\n          messages: [new HumanMessage(message)],\n        },\n        { configurable: { thread_id: threadId } },\n      );\n\n      for (const message of agentFinalState.messages) {\n        yield message.content as string;\n      }\n    } catch (error) {\n      console.error('Error streaming response:', error);\n      throw error;\n    }\n  }\n\n  // Add more tools to the agent\n  addTool(tool: any) {\n    this.tools.push(tool);\n    // Recreate agent with updated tools\n    this.agent = createReactAgent({\n      llm: this.model,\n      tools: this.tools,\n    });\n  }\n\n  // Get the current configuration\n  getConfig(): AgentConfig {\n    return {\n      model: this.model.model,\n      temperature: this.model.temperature,\n      maxResults: 3, // Return default value since we can't access protected property\n    };\n  }\n}\n\n// Example usage:\n// const agent = new SeedingAgent({\n//   model: 'gemini-2.0-flash',\n//   temperature: 0,\n//   maxResults: 3,\n// });\n// agent\n//   .invoke('what is the current weather in sf')\n//   .then((response) => {\n//     console.log(response);\n//   });\n// Stream response\n// for await (const chunk of agent.streamResponse('what is the current weather in sf')) {\n//   console.log(chunk);\n// }\n"],"names":["SeedingAgent","invoke","message","threadId","agentFinalState","agent","messages","HumanMessage","configurable","thread_id","lastMessage","length","content","error","console","streamResponse","addTool","tool","tools","push","createReactAgent","llm","model","getConfig","temperature","maxResults","constructor","config","ChatGoogleGenerativeAI","TavilySearchResults"],"mappings":";;;;+BAYaA;;;eAAAA;;;+BAZuB;6BACG;0BACV;0BACI;QAC1B;;;;;;;;;;;;;;AAQA,MAAMA;IAyBX,MAAMC,OACJC,OAAe,EACfC,WAAmB,SAAS,EACX;QACjB,IAAI;YACF,MAAMC,kBAAkB,MAAM,IAAI,CAACC,KAAK,CAACJ,MAAM,CAC7C;gBACEK,UAAU;oBAAC,IAAIC,sBAAY,CAACL;iBAAS;YACvC,GACA;gBAAEM,cAAc;oBAAEC,WAAWN;gBAAS;YAAE;YAG1C,MAAMO,cACJN,gBAAgBE,QAAQ,CACtBF,gBAAgBE,QAAQ,CAACK,MAAM,GAAG,EACnC;YACH,OAAOD,YAAYE,OAAO;QAC5B,EAAE,OAAOC,OAAO;YACdC,QAAQD,KAAK,CAAC,yBAAyBA;YACvC,MAAMA;QACR;IACF;IAEA,OAAOE,eACLb,OAAe,EACfC,WAAmB,SAAS,EACJ;QACxB,IAAI;YACF,MAAMC,kBAAkB,MAAM,IAAI,CAACC,KAAK,CAACJ,MAAM,CAC7C;gBACEK,UAAU;oBAAC,IAAIC,sBAAY,CAACL;iBAAS;YACvC,GACA;gBAAEM,cAAc;oBAAEC,WAAWN;gBAAS;YAAE;YAG1C,KAAK,MAAMD,WAAWE,gBAAgBE,QAAQ,CAAE;gBAC9C,MAAMJ,QAAQU,OAAO;YACvB;QACF,EAAE,OAAOC,OAAO;YACdC,QAAQD,KAAK,CAAC,6BAA6BA;YAC3C,MAAMA;QACR;IACF;IAGAG,QAAQC,IAAS,EAAE;QACjB,IAAI,CAACC,KAAK,CAACC,IAAI,CAACF;QAEhB,IAAI,CAACZ,KAAK,GAAGe,IAAAA,0BAAgB,EAAC;YAC5BC,KAAK,IAAI,CAACC,KAAK;YACfJ,OAAO,IAAI,CAACA,KAAK;QACnB;IACF;IAGAK,YAAyB;QACvB,OAAO;YACLD,OAAO,IAAI,CAACA,KAAK,CAACA,KAAK;YACvBE,aAAa,IAAI,CAACF,KAAK,CAACE,WAAW;YACnCC,YAAY;QACd;IACF;IAjFAC,YAAYC,SAAsB,CAAC,CAAC,CAAE;QAJtC,uBAAQtB,SAAR,KAAA;QACA,uBAAQiB,SAAR,KAAA;QACA,uBAAQJ,SAAR,KAAA;QAGE,MAAM,EACJI,QAAQ,kBAAkB,EAC1BE,cAAc,CAAC,EACfC,aAAa,CAAC,EACf,GAAGE;QAEJ,IAAI,CAACL,KAAK,GAAG,IAAIM,mCAAsB,CAAC;YACtCJ;YACAF;QACF;QAEA,IAAI,CAACJ,KAAK,GAAG;YAAC,IAAIW,kCAAmB,CAAC;gBAAEJ;YAAW;SAAG;QAEtD,IAAI,CAACpB,KAAK,GAAGe,IAAAA,0BAAgB,EAAC;YAC5BC,KAAK,IAAI,CAACC,KAAK;YACfJ,OAAO,IAAI,CAACA,KAAK;QACnB;IACF;AAgEF"}